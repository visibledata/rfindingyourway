---
title: Rounding in tibbles and pillar
author: Martin John Hadley
date: '2018-01-31'
slug: rounding-in-tibbles-and-pillar
categories:
  - R
  - tidyverse
tags:
  - tidyverse
draft: yes
publishdate: "2018-03-01"
---



<p>Tibble column chopping is a thing <a href="https://twitter.com/dataandme/status/956316981690585090" class="uri">https://twitter.com/dataandme/status/956316981690585090</a></p>
<p>I got a question from yup Chenzi Xu <a href="mailto:chenzi.xu@seh.ox.ac.uk">chenzi.xu@seh.ox.ac.uk</a></p>
<p>Issue: <a href="https://github.com/r-lib/pillar/issues/93" class="uri">https://github.com/r-lib/pillar/issues/93</a></p>
<p>There are good options for controlling these <a href="https://www.tidyverse.org/articles/2018/01/tibble-1-4-2/?utm_content=buffer418b3&amp;utm_medium=social&amp;utm_source=twitter.com&amp;utm_campaign=buffer" class="uri">https://www.tidyverse.org/articles/2018/01/tibble-1-4-2/?utm_content=buffer418b3&amp;utm_medium=social&amp;utm_source=twitter.com&amp;utm_campaign=buffer</a></p>
<p>But should there be an option for yeah turning off rounding?</p>
<pre class="r"><code>library(&quot;tidyverse&quot;)</code></pre>
<pre><code>## ── Attaching packages ───────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 2.2.1     ✔ purrr   0.2.4
## ✔ tibble  1.4.2     ✔ dplyr   0.7.4
## ✔ tidyr   0.8.0     ✔ stringr 1.2.0
## ✔ readr   1.1.1     ✔ forcats 0.2.0</code></pre>
<pre><code>## ── Conflicts ──────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>string_numbers &lt;- tibble(
  id = 1:5,
  na.and.both = c(&quot;100.49&quot;, &quot;200&quot;, &quot;300&quot;, &quot;400.51&quot;, NA),
  both.types = c(&quot;100.49&quot;, &quot;200&quot;, &quot;300&quot;, &quot;400.51&quot;, &quot;500&quot;),
  all.integers = c(&quot;100&quot;, &quot;200&quot;, &quot;300&quot;, &quot;400&quot;, &quot;500&quot;),
  all.doubles = c(&quot;100.494&quot;, &quot;200.494&quot;, &quot;300.514&quot;, &quot;400.514&quot;, &quot;500.514&quot;),
  bigger.decimals = c(&quot;121.3444&quot;, &quot;2232.444&quot;, &quot;343.3424&quot;, &quot;4424.4344&quot;, &quot;5453.33&quot;)
)

chenzi_data &lt;- tibble(
  id = 1:5,
  pitch = c(&quot;275.480&quot;, &quot;230&quot;, &quot;240.0&quot;, &quot;402.33&quot;, NA),
  all.decimal = c(&quot;230.1&quot;, &quot;101.3&quot;, &quot;707.2&quot;, &quot;5905.3&quot;, &quot;56.1&quot;)
)

options(pillar.sigfig = 3)

chenzi_data %&gt;%
  mutate(pitch = parse_double(pitch, locale = locale(decimal_mark = &quot;.&quot;)))</code></pre>
<pre><code>## # A tibble: 5 x 3
##      id pitch all.decimal
##   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      
## 1     1   275 230.1      
## 2     2   230 101.3      
## 3     3   240 707.2      
## 4     4   402 5905.3     
## 5     5    NA 56.1</code></pre>
<pre class="r"><code>strings_parsed &lt;- string_numbers %&gt;%
  mutate(parse_number.na.and.both = parse_number(na.and.both),
         parse_number.both.types = parse_number(both.types),
         parse_number.all.integers = parse_number(all.integers),
         parse_number.all.doubles = parse_number(all.doubles)) %&gt;%
  mutate(parse_double.na.and.both = parse_number(na.and.both),
         parse_double.both.types = parse_double(both.types),
         parse_double.all.integers = parse_double(all.integers),
         parse_double.all.doubles = parse_double(all.doubles)) %&gt;%
  mutate(parse_number.bigger.decimals = parse_number(bigger.decimals))</code></pre>
<p>MAKE A GITHUB ISSUE ABOUT THIS</p>
